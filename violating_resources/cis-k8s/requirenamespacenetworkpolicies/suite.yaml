kind: Suite
apiVersion: test.gatekeeper.sh/v1alpha1
metadata:
  name: k8srequirenamespacenetworkpolicies
tests:
  - name: k8srequirenamespacenetworkpolicies
    template: template.yaml
    constraint: samples/require-namespace-network-policies/constraint.yaml
    cases:
      # TODO (b/211655596): We don't have a way of showing referential data in
      # doc-gen. We need to add that.
      - name: network-policy-exists
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory:
          - samples/require-namespace-network-policies/example_allowed_network-policy.yaml
        assertions:
          - violations: no
      - name: network-policy-does-not-exist
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory: []
        assertions:
          - violations: yes
  - name: cis-k8srequirenamespacenetworkpolicies
    template: template.yaml
    constraint: samples/cis-k8s-1.5.1/5.3.2_require-namespace-network-policies.yaml
    cases:
      - name: network-policy-exists
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory:
          - samples/require-namespace-network-policies/example_allowed_network-policy.yaml
        assertions:
          - violations: no
      - name: network-policy-does-not-exist
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory: []
        assertions:
          - violations: yes
  - name: pci-k8srequirenamespacenetworkpolicies
    template: template.yaml
    constraint: samples/pci-dss-3.2.1/1.2.0_pci-require-namespace-network-policies.yaml
    cases:
      - name: network-policy-exists
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory:
          - samples/require-namespace-network-policies/example_allowed_network-policy.yaml
        assertions:
          - violations: no
      - name: network-policy-does-not-exist
        object: samples/require-namespace-network-policies/example_disallowed_namespace.yaml
        inventory: []
        assertions:
          - violations: yes
